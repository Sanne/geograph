<?xml version="1.0" encoding="UTF-8"?>
<cluster xmlns="http://www.globus.org/2008/06/workspace/metadata/logistics">


<!-- Load Balancers -->
 <workspace>  
    <name>load-balancer</name>
    <image>torquebox-2centos-5.7.gz</image>    
    <quantity>1</quantity>    
    <nic wantlogin="true">public</nic>
    <ctx>
         <provides>
               <identity />
               <role>geograph-mod-cluster</role>
         </provides>
         <requires>
                <identity/>
 				<data name="mod-cluster">mod_cluster</data>
         </requires>
    </ctx>
 </workspace>

 <workspace>
    <name>agent-farm-load-balancer</name>
    <image>torquebox-2centos-5.7.gz</image>
    <quantity>1</quantity>
    <nic wantlogin="true">public</nic>
    <ctx>
         <provides>
               <identity />
               <role>agent-farm-mod-cluster</role>
         </provides>
         <requires>
                <identity/>
 				<data name="mod-cluster">mod_cluster</data>
         </requires>
    </ctx>
 </workspace>

 <!-- App nodes -->
 <workspace>
    <name>geograph-node</name>
    <image>torquebox-2centos-5.7.gz</image>
    <quantity>2</quantity>
    <nic wantlogin="true">public</nic>
    <ctx>
         <provides>
               <identity />
               <role>geograph</role>
         </provides>
         <requires>
                <identity/>
                <role name="usersdb" hostname="true"  pubkey="true" />
                <role name="geograph" hostname="true"  pubkey="true" />
                <role name="geograph-mod-cluster" hostname="true"  pubkey="true" />
                <data name="geograph">setdb</data>
         </requires>
    </ctx>
 </workspace>



 <!-- DB Users -->
 <workspace>
    <name>user-database-node</name>
    <image>torquebox-2centos-5.7.gz</image>
    <quantity>1</quantity>
    <nic wantlogin="true">public</nic>
    <ctx>
         <provides>
            <identity />
            <role>usersdb</role>
         </provides>
          <requires>
            <identity/>
            <data name="usersdb">mysql</data>
         </requires>
    </ctx>
 </workspace>

  <!-- Workload generator nodes -->
  <workspace>
     <name>agent-farm-node</name>
     <image>torquebox-2centos-5.7.gz</image>
     <quantity>1</quantity>
     <nic wantlogin="true">public</nic>
     <ctx>
          <provides>
             <identity />
             <role>agent-farm</role>
          </provides>
          <requires>
             <identity/>

             <!-- run scripts 1-ipandhost/agent-farm -->
             <role name="agent-farm" hostname="true"  pubkey="true" />

             <!-- run script 1-ipandhost/agent-farm -->
             <role name="usersdb" hostname="true"  pubkey="true" />

             <!-- run scripts 1-ipandhost/agent-farm-mod-cluster and 4-restarts/agent-farm-mod-cluster -->
             <role name="agent-farm-mod-cluster" hostname="true"  pubkey="true" />

             <!-- run script 3-data/agent-farm -->
             <data name="agent-farm">setdb</data>
          </requires>
     </ctx>
  </workspace>

</cluster>
